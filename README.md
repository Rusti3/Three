# Floating Islands (Three.js)\r\n\r\nInteractive Three.js scene where floating islands are generated procedurally.\r\n\r\n## Run\r\n\r\n`ash\r\nnpm install\r\nnpm run dev\r\n`\r\n\r\n## Tests\r\n\r\n`ash\r\nnpm run test:unit\r\nnpm run test:e2e\r\n`\r\n\r\n## Controls\r\n\r\n- Click canvas: spawn a new floating island in a random free position.\r\n- Mouse drag: orbit camera.\r\n- Mouse wheel: zoom in/out.\r\n- Right mouse drag: pan camera.\r\n- On each click, all island generation parameters are randomized in safe ranges.\r\n\r\n## Parameters Per Island\r\n\r\nThe right panel values are applied to the **next spawned island**:\r\n\r\n- SEED\r\n- N\r\n- XY_SCALE\r\n- Z_SCALE\r\n- MOUNTAIN_AMP\r\n- CLIFF_AMP\r\n\r\nDefault values:\r\n\r\n- SEED = 4121132\r\n- N = 160\r\n- XY_SCALE = 32.0\r\n- Z_SCALE = 10.0\r\n- MOUNTAIN_AMP = 0.58\r\n- CLIFF_AMP = 0.07\r\n\r\n## Version Summary\r\n\r\n### v0.4.1 (2026-02-26)\r\n\r\nWhat was done:\r\n- Swapped the rail kit to РЕЛЬСыконечные.glb for start/end anchors and РЕЛЬСыосновные.glb for the path.\r\n- Each MST edge now begins with the anchor piece, fills the gap with repeated path pieces, and ends with the anchor again.\r\n- Cloned every segment so the straight-line layout stays consistent regardless of island positions.\r\n- Updated the rail modules/tests to reflect the new asset arrangement and loading path.\r\n\r\nWhy these functions were added:\r\n- To meet the new requirement: anchor the line on each island with the special model, use the path model for the middle of the run, and finish with the anchor.\r\n\r\nWhat changed for the user:\r\n- Rails now reuse two glTF models: one for start/end anchors and one for the connecting track.\r\n- Every time a new island appears, the MST rebuild keeps the anchor → path → anchor pattern on each rail.\r\n- The debug API/e2e tests still report how many segments are present so you can confirm rails stay healthy.\r\n\r\n### v0.4.0 (2026-02-26)\r\n\r\nWhat was done:\r\n- Added automatic rail generation between islands.\r\n- Implemented MST topology so all islands become connected with minimal number of links.\r\n- Added full rail network rebuild after each new island spawn.\r\n- Added rail modules and tests (ailGraph, ailBuilder, ailKit).\r\n- Extended debug API and e2e smoke to verify rail segments appear after the second island.\r\n\r\nWhy these functions were added:\r\n- To automatically connect generated islands into one navigable rail network.\r\n\r\nWhat changed for the user:\r\n- After islands spawn, rails now appear automatically between them.\r\n- Rail lines are rebuilt dynamically when new islands are added.\r\n\r\n### v0.3.3 (2026-02-26)\r\n\r\nWhat was done:\r\n- Added automatic randomization of all generation parameters on every canvas click.\r\n- UI fields are now updated per click before spawning each island.\r\n- Added unit tests for random parameter range correctness.\r\n\r\nWhy these functions were added:\r\n- To guarantee each new island has a fresh configuration automatically.\r\n- To keep randomness within practical limits and avoid extreme unstable values.\r\n\r\nWhat changed for the user:\r\n- You no longer need to edit fields manually for variation; each click randomizes all params and spawns a new island.\r\n\r\n### v0.3.2 (2026-02-26)\r\n\r\nWhat was done:\r\n- Fixed island top rendering artifacts by forcing opaque double-sided island material.\r\n\r\nWhy these functions were added:\r\n- To prevent the upper island surface from looking semi-transparent due to face culling artifacts.\r\n\r\nWhat changed for the user:\r\n- Top side of islands now renders visually solid.\r\n\r\n### v0.3.1 (2026-02-26)\r\n\r\nWhat was done:\r\n- Added adaptive LOD for island mesh resolution.\r\n- N now auto-reduces for newly spawned islands when island count grows.\r\n- Added unit tests for adaptive resolution policy.\r\n\r\nWhy these functions were added:\r\n- To keep FPS more stable when many islands are present.\r\n- To preserve high detail for early islands while gradually reducing cost at scale.\r\n\r\nWhat changed for the user:\r\n- You still set N in UI, but at high island counts the actual resolution for new islands may be lower.\r\n- Spawn status now shows daptiveN when automatic reduction is applied.\r\n\r\n### v0.3.0 (2026-02-26)\r\n\r\nWhat was done:\r\n- Removed the old train/rail runtime and related modules/tests.\r\n- Rebuilt the app as an empty-space floating-islands scene.\r\n- Added procedural island generation (main mask + mountain system + warp + cliffs + underside).\r\n- Added click-to-spawn logic with non-overlapping placement.\r\n- Added per-island parameter controls for SEED, N, XY_SCALE, Z_SCALE, MOUNTAIN_AMP, CLIFF_AMP.\r\n- Added OrbitControls camera with mouse zoom.\r\n- Replaced tests with island-focused unit tests and updated e2e smoke.\r\n\r\nWhy these functions were added:\r\n- To generate distinct, controllable procedural islands directly in browser runtime.\r\n- To prevent island intersections while allowing unlimited spawning until space is exhausted.\r\n- To let users tune terrain behavior per island without rebuilding code.\r\n\r\nWhat changed for the user:\r\n- No train/rail scene anymore.\r\n- Clicking the scene now creates floating islands.\r\n- Camera can orbit/pan/zoom with mouse.\r\n- Terrain parameters can be changed before each new island spawn.\r\n
